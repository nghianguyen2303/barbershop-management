<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Thá»‘ng kÃª doanh thu</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: Arial; padding: 20px; background: #f4f4f4; }
        .card {
            padding: 20px; background: white; border-radius: 10px;
            margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { padding: 10px; border: 1px solid #ccc; text-align: center; }
        select { padding: 8px; }
    </style>
</head>

<body>

<h2>ğŸ“Š Thá»‘ng kÃª doanh thu theo thÃ¡ng</h2>

<!-- Chá»n nÄƒm cáº§n xem -->
<div class="card">
    <label><strong>Chá»n nÄƒm:</strong></label>
    <select id="selectNam" onchange="changeYear()">
        <option th:each="y : ${#numbers.sequence(2022, 2030)}"
                th:value="${y}"
                th:selected="${y == nam}"
                th:text="${y}">
        </option>
    </select>
</div>

<!-- Biá»ƒu Ä‘á»“ -->
<div class="card">
    <h3>Biá»ƒu Ä‘á»“ doanh thu theo thÃ¡ng</h3>
    <canvas id="chartDoanhThu" height="120"></canvas>
</div>

<!-- Báº£ng doanh thu -->
<div class="card">
    <h3>Báº£ng doanh thu theo thÃ¡ng</h3>
    <table>
        <tr>
            <th>ThÃ¡ng</th>
            <th>Doanh thu (VNÄ)</th>
        </tr>

        <tr th:each="t, i : ${#numbers.sequence(1,12)}">
            <td th:text="${t}"></td>
            <td th:text="${#numbers.formatDecimal(doanhThu[i.index],0,'COMMA',0,'POINT')}"></td>
        </tr>
    </table>
</div>

<a href="/admin/home">â† Quay láº¡i Dashboard</a>

<script>

    function changeYear() {
        const year = document.getElementById("selectNam").value;
        window.location.href = "/admin/thongke?nam=" + year;
    }

    // Load dá»¯ liá»‡u biá»ƒu Ä‘á»“
    const nam = document.getElementById("selectNam").value;

    fetch(`/admin/thongke/chart-data?nam=${nam}`)
        .then(res => res.json())
        .then(data => {
            const ctx = document.getElementById("chartDoanhThu");

            new Chart(ctx, {
                type: "bar",
                data: {
                    labels: data.thang,
                    datasets: [{
                        label: "Doanh thu (VNÄ)",
                        data: data.doanhThu,
                        borderWidth: 1
                    }]
                }
            });
        });

</script>

</body>
</html>
